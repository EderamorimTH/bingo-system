<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Painel Admin - Bingo</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="/socket.io/socket.io.js"></script>
<style>
body { background-color: #f7f9fc; }
h1 { color: #0d6efd; }
.table td, .table th { vertical-align: middle; }
.btn-copy { cursor: pointer; }
.vencedor-msg { color: green; font-weight: bold; }
</style>
</head>
<body class="p-4">

<div class="container">

<h1>Painel Admin - Bingo</h1>
<hr>

<h3>Controle de Sorteio</h3>
<p><strong>Últimos números sorteados:</strong> <%= ultimosNumeros.join(', ') %></p>
<p><strong>Prêmio atual:</strong> <%= premioAtual %></p>

<form action="/sortear" method="POST" class="mb-2">
<button type="submit" class="btn btn-primary">Sortear Número Automático</button>
</form>

<form action="/premio" method="POST" class="mb-2">
<input type="text" name="premio" placeholder="Atualizar prêmio" class="form-control d-inline-block w-auto">
<button type="submit" class="btn btn-warning">Atualizar Prêmio</button>
</form>

<form action="/reiniciar" method="POST" class="mb-2">
<button type="submit" class="btn btn-danger">Reiniciar Bingo</button>
</form>

<hr>

<h3>Cartelas</h3>
<form action="/atribuir" method="POST" class="mb-3 d-flex gap-2">
<input type="number" name="id" placeholder="ID Cartela" class="form-control w-auto" required>
<input type="text" name="nome" placeholder="Nome Jogador" class="form-control" required>
<input type="text" name="telefone" placeholder="Telefone" class="form-control" required>
<button type="submit" class="btn btn-success">Atribuir Cartela</button>
</form>

<table class="table table-striped table-bordered">
<thead class="table-dark">
<tr>
<th>ID</th>
<th>Dono</th>
<th>Telefone</th>
<th>Link Cartela</th>
<th>Prêmio</th>
</tr>
</thead>
<tbody>
<% cartelas.forEach(c => { %>
<tr>
<td><%= c.id %></td>
<td><%= c.dono %></td>
<td><%= c.telefone.replace(/^(\d{2})\d+(\d{3})$/, "$1*****$2") %></td>
<td><input type="text" value="<%= 'https://bingo-system.onrender.com/cartela/' + c.id %>" readonly class="form-control w-auto d-inline-block">
<button class="btn btn-secondary btn-copy" data-link="<%= 'https://bingo-system.onrender.com/cartela/' + c.id %>">Copiar</button></td>
<td><%= c.premio %></td>
</tr>
<% }) %>
</tbody>
</table>

<hr>
<h3>Vencedores</h3>
<ul>
<% vencedores.forEach(v => { %>
<li class="vencedor-msg">Cartela <%= v.id %> - <%= v.dono %> | <%= v.telefone.replace(/^(\d{2})\d+(\d{3})$/, "$1*****$2") %> | Prêmio: <%= v.premio %></li>
<% }) %>
</ul>

</div>

<script>
const socket = io();
document.querySelectorAll('.btn-copy').forEach(btn => {
    btn.addEventListener('click', () => {
        navigator.clipboard.writeText(btn.dataset.link);
        alert('Link copiado!');
    });
});
</script>

</body>
</html>
